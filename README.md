# BSA-PERCEPT
В этом задании вы будете создавать приложение с возможностями Computer Vision. Вам предстоит создать веб сервис для поиска похожих изображений.

## Требования к приложению

Сервис должен поддреживать 4 операции:
1) загрузить несколько изображений в базу для распознавания
2) Загрузить 1 изображение для поиска. Если оно найдено небыло, то добавить его в базу
3) удалить изображение из базы по id
4) удалить все изображения из базы

Загруженные изображения сохраняются на жестком диске. Подсчитаный хеш с id и путем к изображению сохраняется в "пресистентное хранилище". 
Это может быть как просто коллекция в памяти, так и база данных(в этом случае используй PostgreSQL).  
Операции с файловой системой следует вынести в сервис, который будет предоставлять асинхронный API.

При обработке батч запроса запись на жесткий диск и подсчет хеша должны происходить паралельно, после того как обе операции закончатся необходимо создать запись с информацией об изображении в персистентном хранилище. После сохранения всех изображений в массиве необходимо вернуть ответ клиенту:
```
                                   Изображение 1 -----> подсчет хеша --------------> запись в персистентное хранилище--\ 
                                 /               \                               /                                      \                   
                                /                 --- запись на жесткий диск ---/                                        \
                               /                                                                                          \
- Получение массива изображений                                                                                           -----> отправка ответа клиенту
                               \                                                                                         /
                                \                                                                                       /
                                 \                                                                                     /
                                  Изображение 2 -----> подсчет хеша --------------> запись в персистентное хранилище--/ 
                                                \                               /
                                                 --- запись на жесткий диск ---/
``` 

В случае поиска изображения, если небыло найдено ни одного совпадения, необходимо также как и при батч загрузке записать файл на диск и создать запись в персистентном хранилище, однако ответ отправляется не дожидаясь окончания данных операций:
```
 Изображение --> подсчет хеша ----> поиск совпадений в персистентном хранилище ------> отправка ответа клиенту ---------------------------------------------->
                                                                              \
                                                                               \                                                                                                                                                         
                                                                                \---запись на жесткий диск --------> запись в персистентное хранилище ------->
```

Удаление сущностей реализуйте на ваше усмотрение.

Приложение должно предоставлять 4 эндпоинта:
```
POST /image/batch
content-type: multipart/form-data
images: MultipartFile[]

Загружает несколько файлов, считает хеш, сохраняет изображения на диске и создает запись в персистентном хранилище.

POST /image/search?threshold=?
content-type: multipart/form-data
image: MultipartFile

Response: [
    {
        id: "92c73b0f-77d6-41b9-be87-1e0ebf20be31",
        image: "http://127.0.0.1:8080/files/92c73b0f-77d6-41b9-be87-1e0ebf20be31.jpg",
        match: 96.1265
    }
]

Загружает файл, поиск которого необходимо выполнить в персистентном хранилище с указаным минимальным процентом совпадения(threshold). Threshold должен находится в пределах (0, 1], при его отсутствии в качестве значения по умолчанию использовать 0.9. Если похожие изображения не найдены, то необходимо сохранить его на диск и добавить запись в персистентное хранилище.

DELETE /image/{id}

Удаляет указанное изображение из персистентного хранилища и с жесткого диска

DELETE /image/purge

Удаляет все изображения с жесткого диска и из персистентного хранилища
```
Также приложение должно предоставлять доступ к сохраненным изображениям по ссылке.
